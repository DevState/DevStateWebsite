(function(a){ImageEffects=function(){};ImageEffects.createGrayscaleImageFrom=function(g,d,m){var f=document.createElement("canvas");var e=f.getContext("2d");f.width=d;f.height=m;e.drawImage(g,0,0,d,m);var c=e.getImageData(0,0,f.width,f.height);for(var k=0;k<c.height;k++){for(var l=0;l<c.width;l++){var h=(k*4)*c.width+l*4;var j=(c.data[h]+c.data[h+1]+c.data[h+2])/3;c.data[h]=j;c.data[h+1]=j;c.data[h+2]=j}}e.putImageData(c,0,0,0,0,c.width,c.height);var b=new Image();b.src=f.toDataURL();delete e;delete f;return b};ImageEffects.createInverseImageFrom=function(g,c,k){var e=document.createElement("canvas");var d=e.getContext("2d");e.width=c;e.height=k;d.drawImage(g,0,0,c,k);var f=d.getImageData(0,0,e.width,e.height);var h=f.data;for(var j=0;j<f.data.length;j+=4){h[j]=255-h[j];h[j+1]=255-h[j+1];h[j+2]=255-h[j+2]}d.putImageData(f,0,0,0,0,f.width,f.height);var b=new Image();b.src=e.toDataURL();delete d;delete e;return b};ImageEffects.createBrightImageFrom=function(g,c,k){var e=document.createElement("canvas");var d=e.getContext("2d");e.width=c;e.height=k;d.drawImage(g,0,0,c,k);var f=d.getImageData(0,0,e.width,e.height);var h=f.data;for(var j=0;j<f.data.length;j+=4){h[j]=h[j]+(255-h[j])/1.3;h[j+1]=h[j+1]+(255-h[j+1])/1.3;h[j+2]=h[j+2]+(255-h[j+2])/1.3}d.putImageData(f,0,0,0,0,f.width,f.height);var b=new Image();b.src=e.toDataURL();delete d;delete e;return b};ImageEffects.createDarkImageFrom=function(g,c,k){var e=document.createElement("canvas");var d=e.getContext("2d");e.width=c;e.height=k;d.drawImage(g,0,0,c,k);var f=d.getImageData(0,0,e.width,e.height);var h=f.data;for(var j=0;j<f.data.length;j+=4){h[j]=h[j]*0.3;h[j+1]=h[j+1]*0.3;h[j+2]=h[j+2]*0.3}d.putImageData(f,0,0,0,0,f.width,f.height);var b=new Image();b.src=e.toDataURL();delete d;delete e;return b};ImageEffects.createPsychadelicImageFrom=function(g,c,k){var e=document.createElement("canvas");var d=e.getContext("2d");e.width=c;e.height=k;d.drawImage(g,0,0,c,k);var f=d.getImageData(0,0,e.width,e.height);var h=f.data;for(var j=0;j<f.data.length;j+=4){h[j]=h[j]<127?h[j]+(255-h[j])/1.3:h[j];h[j+1]=h[j+1]<127?h[j+1]+(255-h[j+1])/1.3:h[j+1];h[j+2]=h[j+2]<127?h[j+2]+(255-h[j+2])/1.3:h[j+2]}d.putImageData(f,0,0,0,0,f.width,f.height);var b=new Image();b.src=e.toDataURL();delete d;delete e;return b};ImageEffects.effects=new Array(ImageEffects.createGrayscaleImageFrom,ImageEffects.createInverseImageFrom,ImageEffects.createBrightImageFrom,ImageEffects.createDarkImageFrom,ImageEffects.createPsychadelicImageFrom);ImageEffects.getRandomImageEffect=function(){return ImageEffects.effects[Math.floor(Math.random()*ImageEffects.effects.length)]};ImageEffects.createRandomEffectImageFrom=function(e,d,b){var c=ImageEffects.getRandomImageEffect();return c(e,d,b)};ImageEffects.renderReflection=function(d,h,i,f,c,e){if(!i){i=5}if(!f){f=e=c="0xFF"}context=d.getContext("2d");context.translate(h.x,h.y+h.height*2+i);context.scale(1,-1);context.drawImage(d,h.x,h.y,h.width,h.height,0,0,h.width,h.height);SimpleGeometry.setIdentityMatrixToContext(context);var j=context.createLinearGradient(h.x,h.y+h.height+i,h.x,h.y+h.height*1.5);j.addColorStop(0.1,"rgba(255,255,255,0)");j.addColorStop(0.5,"rgba(255,255,255,.7)");j.addColorStop(1,"rgb(255,255,255)");context.fillStyle=j;context.fillRect(h.x,h.y+h.height+i,h.width,h.height)};ImageEffects.resizeImageDestructive=function(f,c,e,b){if(!c){c=document.createElement("canvas")}c.width=e;c.height=b;var d=c.getContext("2d");d.drawImage(f,0,0,e,b);f.src=c.toDataURL()};a.ImageEffects=ImageEffects}(window));