(function(a){AbstractIsometricSpace=function(d,e,c,b,f){this.frontLeftTop=new SimpleGeometry.Point();this.frontLeftBottom=new SimpleGeometry.Point();this.backLeftTop=new SimpleGeometry.Point();this.backLeftBottom=new SimpleGeometry.Point();this.frontRightTop=new SimpleGeometry.Point();this.frontRightBottom=new SimpleGeometry.Point();this.backRightTop=new SimpleGeometry.Point();this.backRightBottom=new SimpleGeometry.Point();this.stageWidth=d;this.stageHeight=e;this.width=c;this.height=b;this.depth=f;this.updatePoints()};AbstractIsometricSpace.prototype.updateStage=function(b,c){this.stageWidth=b;this.stageHeight=c;this.updatePoints()};AbstractIsometricSpace.prototype.updateSpaceContainer=function(c,b,d){this.width=c;this.height=b;this.depth=d;this.updatePoints()};AbstractIsometricSpace.prototype.updatePoints=function(){console.error("AbstractIsometricSpace.updatePoints() ERROR : subclasses must override this method")};AbstractIsometricSpace.prototype.frontLeft=new SimpleGeometry.Point();AbstractIsometricSpace.prototype.backLeft=new SimpleGeometry.Point();AbstractIsometricSpace.prototype.frontRight=new SimpleGeometry.Point();AbstractIsometricSpace.prototype.backRight=new SimpleGeometry.Point();AbstractIsometricSpace.prototype.leftZ=new SimpleGeometry.Point();AbstractIsometricSpace.prototype.rightZ=new SimpleGeometry.Point();AbstractIsometricSpace.prototype.project=function(c,b){this.frontLeft.x=this.frontLeftBottom.x;this.frontLeft.y=SimpleGeometry.interpolate(c.y,this.frontLeftBottom.y,this.frontLeftTop.y);this.backLeft.x=this.backLeftBottom.x;this.backLeft.y=SimpleGeometry.interpolate(c.y,this.backLeftBottom.y,this.backLeftTop.y);this.frontRight.x=this.frontRightBottom.x;this.frontRight.y=SimpleGeometry.interpolate(c.y,this.frontRightBottom.y,this.frontRightTop.y);this.backRight.x=this.backRightBottom.x;this.backRight.y=SimpleGeometry.interpolate(c.y,this.backRightBottom.y,this.backRightTop.y);this.leftZ.x=SimpleGeometry.interpolate(c.z,this.frontLeft.x,this.backLeft.x);this.leftZ.y=SimpleGeometry.interpolate(c.z,this.frontLeft.y,this.backLeft.y);this.rightZ.x=SimpleGeometry.interpolate(c.z,this.frontRight.x,this.backRight.x);this.rightZ.y=SimpleGeometry.interpolate(c.z,this.frontRight.y,this.backRight.y);b.x=SimpleGeometry.interpolate(c.x,this.leftZ.x,this.rightZ.x);b.y=SimpleGeometry.interpolate(c.x,this.leftZ.y,this.rightZ.y)};AbstractIsometricSpace.prototype.renderWireframe=function(b,c){b.strokeStyle=c==undefined?SimpleGeometry.getRgbaStyleString(255,0,0,0.3):c;b.lineWidth=1;b.beginPath();b.moveTo(this.frontLeftTop.x,this.frontLeftTop.y);b.lineTo(this.frontLeftBottom.x,this.frontLeftBottom.y);b.lineTo(this.backLeftBottom.x,this.backLeftBottom.y);b.lineTo(this.backLeftTop.x,this.backLeftTop.y);b.lineTo(this.frontLeftTop.x,this.frontLeftTop.y);b.closePath();b.stroke();b.beginPath();b.moveTo(this.frontRightTop.x,this.frontRightTop.y);b.lineTo(this.frontRightBottom.x,this.frontRightBottom.y);b.lineTo(this.backRightBottom.x,this.backRightBottom.y);b.lineTo(this.backRightTop.x,this.backRightTop.y);b.lineTo(this.frontRightTop.x,this.frontRightTop.y);b.stroke();b.closePath();b.moveTo(this.backLeftTop.x,this.backLeftTop.y);b.lineTo(this.backRightTop.x,this.backRightTop.y);b.stroke();b.moveTo(this.backLeftBottom.x,this.backLeftBottom.y);b.lineTo(this.backRightBottom.x,this.backRightBottom.y);b.stroke();b.moveTo(this.frontLeftTop.x,this.frontLeftTop.y);b.lineTo(this.frontRightTop.x,this.frontRightTop.y);b.stroke();b.moveTo(this.frontLeftBottom.x,this.frontLeftBottom.y);b.lineTo(this.frontRightBottom.x,this.frontRightBottom.y);b.stroke()};a.AbstractIsometricSpace=AbstractIsometricSpace;IsometricSpaceLeft=function(d,e,c,b,f){AbstractIsometricSpace.call(this,d,e,c,b,f)};IsometricSpaceLeft.prototype=Object.create(AbstractIsometricSpace.prototype);IsometricSpaceLeft.prototype.constructor=AbstractIsometricSpace;IsometricSpaceLeft.prototype.updatePoints=function(){var d=SimpleGeometry.map(this.depth,0,(this.width+this.depth),0,this.stageWidth);var b=-d/Math.cos(SimpleGeometry.degreesToRadians(150));var c=SimpleGeometry.map(1,0,this.depth,0,b);var e=c*this.height;var f=c*this.width;this.backLeftTop.x=d;this.backLeftTop.y=0;this.backLeftBottom.x=d;this.backLeftBottom.y=e;this.frontLeftTop.x=0;this.frontLeftTop.y=b*Math.sin(SimpleGeometry.degreesToRadians(150));this.frontLeftBottom.x=0;this.frontLeftBottom.y=this.frontLeftTop.y+e;this.backRightTop.x=d+f*Math.cos(SimpleGeometry.degreesToRadians(30));this.backRightTop.y=f*Math.sin(SimpleGeometry.degreesToRadians(30));this.backRightBottom.x=this.backRightTop.x;this.backRightBottom.y=this.backRightTop.y+e;this.frontRightTop.x=f*Math.cos(SimpleGeometry.degreesToRadians(30));this.frontRightTop.y=this.frontLeftTop.y+f*Math.sin(SimpleGeometry.degreesToRadians(30));this.frontRightBottom.x=this.frontRightTop.x;this.frontRightBottom.y=this.frontRightTop.y+e};a.IsometricSpaceLeft=IsometricSpaceLeft;IsometricPlane=function(c,d,b,e){if(typeof b==="undefined"){b=null}if(typeof e==="undefined"){e=null}this.lineWeight=1;this.lineColor="#000000";this.lineAlpha=1;this.fillAlpha=1;this.context=c;this.space=d;this.pointA=b?b:new SimpleGeometry.Point3D();this.pointB=e?e:new SimpleGeometry.Point3D()};IsometricPlane.renderPoint=new SimpleGeometry.Point();IsometricPlane.renderPoint3D=new SimpleGeometry.Point3d();IsometricPlane.prototype.setStyles=function(f,d,e,b,c){if(typeof d==="undefined"){d=1}if(typeof e==="undefined"){e="#000000"}if(typeof b==="undefined"){b=1}if(typeof c==="undefined"){c=1}this.fillColor=f;this.fillAlpha=d;this.lineColor=e;this.lineWeight=b;this.lineAlpha=c};IsometricPlane.prototype.render=function(){this.context.beginPath();console.log("IsometricPlane.render() pointA : "+this.pointA+" , pointB : "+this.pointB);this.prepareRender();this.pointA.copyValuesTo(IsometricPlane.renderPoint3D);this.space.project(IsometricPlane.renderPoint3D,IsometricPlane.renderPoint);console.log("\tIsometricPlane.renderPoint : "+IsometricPlane.renderPoint);this.context.moveTo(IsometricPlane.renderPoint.x,IsometricPlane.renderPoint.y);IsometricPlane.renderPoint3D.x=this.pointB.x;IsometricPlane.renderPoint3D.z=this.pointB.z;this.space.project(IsometricPlane.renderPoint3D,IsometricPlane.renderPoint);console.log("\tIsometricPlane.renderPoint : "+IsometricPlane.renderPoint);this.context.lineTo(IsometricPlane.renderPoint.x,IsometricPlane.renderPoint.y);this.pointB.copyValuesTo(IsometricPlane.renderPoint3D);this.space.project(IsometricPlane.renderPoint3D,IsometricPlane.renderPoint);console.log("\tIsometricPlane.renderPoint : "+IsometricPlane.renderPoint);this.context.lineTo(IsometricPlane.renderPoint.x,IsometricPlane.renderPoint.y);IsometricPlane.renderPoint3D.x=this.pointA.x;IsometricPlane.renderPoint3D.z=this.pointA.z;this.space.project(IsometricPlane.renderPoint3D,IsometricPlane.renderPoint);console.log("\tIsometricPlane.renderPoint : "+IsometricPlane.renderPoint);this.context.lineTo(IsometricPlane.renderPoint.x,IsometricPlane.renderPoint.y);this.pointA.copyValuesTo(IsometricPlane.renderPoint3D);this.space.project(IsometricPlane.renderPoint3D,IsometricPlane.renderPoint);console.log("\tIsometricPlane.renderPoint : "+IsometricPlane.renderPoint);this.context.lineTo(IsometricPlane.renderPoint.x,IsometricPlane.renderPoint.y);this.context.fill();this.context.stroke();this.context.closePath()};IsometricPlane.prototype.renderHorizontal=function(){this.context.beginPath();console.log("IsometricPlane.render() pointA : "+this.pointA+" , pointB : "+this.pointB);this.prepareRender();this.pointA.copyValuesTo(IsometricPlane.renderPoint3D);this.space.project(IsometricPlane.renderPoint3D,IsometricPlane.renderPoint);console.log("\tIsometricPlane.renderPoint : "+IsometricPlane.renderPoint);this.context.moveTo(IsometricPlane.renderPoint.x,IsometricPlane.renderPoint.y);IsometricPlane.renderPoint3D.x=this.pointB.x;IsometricPlane.renderPoint3D.y=this.pointB.y;this.space.project(IsometricPlane.renderPoint3D,IsometricPlane.renderPoint);console.log("\tIsometricPlane.renderPoint : "+IsometricPlane.renderPoint);this.context.lineTo(IsometricPlane.renderPoint.x,IsometricPlane.renderPoint.y);this.pointB.copyValuesTo(IsometricPlane.renderPoint3D);this.space.project(IsometricPlane.renderPoint3D,IsometricPlane.renderPoint);console.log("\tIsometricPlane.renderPoint : "+IsometricPlane.renderPoint);this.context.lineTo(IsometricPlane.renderPoint.x,IsometricPlane.renderPoint.y);IsometricPlane.renderPoint3D.x=this.pointA.x;IsometricPlane.renderPoint3D.y=this.pointA.y;this.space.project(IsometricPlane.renderPoint3D,IsometricPlane.renderPoint);console.log("\tIsometricPlane.renderPoint : "+IsometricPlane.renderPoint);this.context.lineTo(IsometricPlane.renderPoint.x,IsometricPlane.renderPoint.y);this.pointA.copyValuesTo(IsometricPlane.renderPoint3D);this.space.project(IsometricPlane.renderPoint3D,IsometricPlane.renderPoint);console.log("\tIsometricPlane.renderPoint : "+IsometricPlane.renderPoint);this.context.lineTo(IsometricPlane.renderPoint.x,IsometricPlane.renderPoint.y);this.context.fill();this.context.stroke();this.context.closePath()};IsometricPlane.prototype.prepareRender=function(){if(this.fillAlpha>0){this.context.fillStyle=this.fillColor}if(this.lineAlpha>0){this.context.strokeStyle=this.lineColor;this.context.lineWidth=this.lineWeight}};a.IsometricPlane=IsometricPlane;IsometricSquare=function(c,d,b,f,e){this.context=c;this.space=d;this.pointA=b?b:new SimpleGeometry.Point3D();this.pointB=f?f:new SimpleGeometry.Point3D();this.pointC=e?e:new SimpleGeometry.Point3D();this.planeLeft=new IsometricPlane(c,d,this.pointA.clone(),this.pointB.clone());this.planeRight=new IsometricPlane(c,d,this.pointB.clone(),this.pointC.clone());this.planeTop=new IsometricPlane(c,d,this.pointA.clone(),this.pointC.clone())};IsometricSquare.prototype.setStyles=function(f,d,e,b,c){this.planeLeft.setStyles(f,d,e,b,c);this.planeRight.setStyles(f,d,e,b,c);this.planeTop.setStyles(f,d,e,b,c)};IsometricSquare.prototype.render=function(){this.planeLeft.render();this.planeRight.render();this.planeTop.renderHorizontal()};a.IsometricSquare=IsometricSquare}(window));