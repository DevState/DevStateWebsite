(function(a){DemoCaptureTool=function(b,d,e,c){console.log("DemoCaptureTool constructor ",b,d);this.captureFrameRate=b;this.playbackFrameRate=d;this.canvases=e;this.outputImage=c;this.captureCanvas=document.createElement("canvas");this.captureCanvas.width=e[0].width;this.captureCanvas.height=e[0].height;this.captureContext=this.captureCanvas.getContext("2d");this.stopping=false};DemoCaptureTool.prototype.start=function(){console.log("DemoCaptureTool.start()");this.numCaptures=0;var b=this;this.intervalId=setInterval(function(){b.capture()},this.captureFrameRate);this.gifEncoder=new GIFEncoder();this.gifEncoder.setRepeat(0);this.gifEncoder.setDelay(this.playbackFrameRate);this.gifEncoder.start();this.capture()};DemoCaptureTool.prototype.stop=function(){console.log("DemoCaptureTool.stop()");clearInterval(this.intervalId);this.gifEncoder.finish();this.outputImage.src="data:image/gif;base64,"+encode64(this.gifEncoder.stream().getData())};DemoCaptureTool.prototype.stopOnNextCapture=function(){this.stopping=true};DemoCaptureTool.prototype.capture=function(){this.captureContext.fillStyle="#FFFFFF";this.captureContext.fillRect(0,0,this.captureCanvas.width,this.captureCanvas.height);var b;for(var c=0;c<this.canvases.length;c++){b=this.canvases[c];this.captureContext.drawImage(b,0,0)}this.gifEncoder.addFrame(this.captureContext);this.numCaptures++;if(this.stopping){clearInterval(this.intervalId);this.gifEncoder.finish();this.outputImage.src="data:image/gif;base64,"+encode64(this.gifEncoder.stream().getData())}};DemoCaptureTool.capturePng=function(e,c,f){if(f==undefined){f="#FFFFFF"}var b=document.createElement("canvas");b.width=e[0].width;b.height=e[0].height;captureContext=b.getContext("2d");captureContext.fillStyle=f;captureContext.fillRect(0,0,b.width,b.height);for(var d=0;d<e.length;d++){canvas=e[d];captureContext.drawImage(canvas,0,0)}c.src=b.toDataURL("image/png")};a.DemoCaptureTool=DemoCaptureTool}(window));