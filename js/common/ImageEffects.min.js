!function(a){ImageEffects=function(){},ImageEffects.createGrayscaleImageFrom=function(a,b,c){var d=document.createElement("canvas"),e=d.getContext("2d");d.width=b,d.height=c,e.drawImage(a,0,0,b,c);for(var f=e.getImageData(0,0,d.width,d.height),g=0;g<f.height;g++)for(var h=0;h<f.width;h++){var i=4*g*f.width+4*h,j=(f.data[i]+f.data[i+1]+f.data[i+2])/3;f.data[i]=j,f.data[i+1]=j,f.data[i+2]=j}e.putImageData(f,0,0,0,0,f.width,f.height);var k=new Image;return k.src=d.toDataURL(),delete e,delete d,k},ImageEffects.createInverseImageFrom=function(a,b,c){var d=document.createElement("canvas"),e=d.getContext("2d");d.width=b,d.height=c,e.drawImage(a,0,0,b,c);for(var f=e.getImageData(0,0,d.width,d.height),g=f.data,h=0;h<f.data.length;h+=4)g[h]=255-g[h],g[h+1]=255-g[h+1],g[h+2]=255-g[h+2];e.putImageData(f,0,0,0,0,f.width,f.height);var i=new Image;return i.src=d.toDataURL(),delete e,delete d,i},ImageEffects.createBrightImageFrom=function(a,b,c){var d=document.createElement("canvas"),e=d.getContext("2d");d.width=b,d.height=c,e.drawImage(a,0,0,b,c);for(var f=e.getImageData(0,0,d.width,d.height),g=f.data,h=0;h<f.data.length;h+=4)g[h]=g[h]+(255-g[h])/1.3,g[h+1]=g[h+1]+(255-g[h+1])/1.3,g[h+2]=g[h+2]+(255-g[h+2])/1.3;e.putImageData(f,0,0,0,0,f.width,f.height);var i=new Image;return i.src=d.toDataURL(),delete e,delete d,i},ImageEffects.createDarkImageFrom=function(a,b,c){var d=document.createElement("canvas"),e=d.getContext("2d");d.width=b,d.height=c,e.drawImage(a,0,0,b,c);for(var f=e.getImageData(0,0,d.width,d.height),g=f.data,h=0;h<f.data.length;h+=4)g[h]=.3*g[h],g[h+1]=.3*g[h+1],g[h+2]=.3*g[h+2];e.putImageData(f,0,0,0,0,f.width,f.height);var i=new Image;return i.src=d.toDataURL(),delete e,delete d,i},ImageEffects.createPsychadelicImageFrom=function(a,b,c){var d=document.createElement("canvas"),e=d.getContext("2d");d.width=b,d.height=c,e.drawImage(a,0,0,b,c);for(var f=e.getImageData(0,0,d.width,d.height),g=f.data,h=0;h<f.data.length;h+=4)g[h]=g[h]<127?g[h]+(255-g[h])/1.3:g[h],g[h+1]=g[h+1]<127?g[h+1]+(255-g[h+1])/1.3:g[h+1],g[h+2]=g[h+2]<127?g[h+2]+(255-g[h+2])/1.3:g[h+2];e.putImageData(f,0,0,0,0,f.width,f.height);var i=new Image;return i.src=d.toDataURL(),delete e,delete d,i},ImageEffects.effects=new Array(ImageEffects.createGrayscaleImageFrom,ImageEffects.createInverseImageFrom,ImageEffects.createBrightImageFrom,ImageEffects.createDarkImageFrom,ImageEffects.createPsychadelicImageFrom),ImageEffects.getRandomImageEffect=function(){return ImageEffects.effects[Math.floor(Math.random()*ImageEffects.effects.length)]},ImageEffects.createRandomEffectImageFrom=function(a,b,c){var d=ImageEffects.getRandomImageEffect();return d(a,b,c)},ImageEffects.renderReflection=function(a,b,c,d,e,f){c||(c=5),d||(d=f=e="0xFF"),context=a.getContext("2d"),context.translate(b.x,b.y+2*b.height+c),context.scale(1,-1),context.drawImage(a,b.x,b.y,b.width,b.height,0,0,b.width,b.height),SimpleGeometry.setIdentityMatrixToContext(context);var g=context.createLinearGradient(b.x,b.y+b.height+c,b.x,b.y+1.5*b.height);g.addColorStop(.1,"rgba(255,255,255,0)"),g.addColorStop(.5,"rgba(255,255,255,.7)"),g.addColorStop(1,"rgb(255,255,255)"),context.fillStyle=g,context.fillRect(b.x,b.y+b.height+c,b.width,b.height)},ImageEffects.resizeImageDestructive=function(a,b,c,d){b||(b=document.createElement("canvas")),b.width=c,b.height=d;var e=b.getContext("2d");e.drawImage(a,0,0,c,d),a.src=b.toDataURL()},a.ImageEffects=ImageEffects}(window);